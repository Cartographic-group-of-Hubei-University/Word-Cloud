<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <script type="text/javascript" src="https://unpkg.com/xlsx@0.14.0/dist/xlsx.full.min.js"></script> -->
    　
    <script src="http://libs.baidu.com/jquery/2.1.4/jquery.min.js"></script>
    <input type="button" value="导出" onclick="result()" />
    <title>Document</title>
</head>

<body>
    <script type="text/javascript">
        function result() {
            var count = 0;
            var names = [
    "多莫大教堂",
    "星空失恋博物馆",
    "中国地质大学逸夫博物馆",
    "马鞍山森林公园-烧烤区",
    "东湖音乐公园",
    "马鞍山森林公园-湿地公园",
    "东湖梅园",
    "武汉植物园",
    "马鞍山森林公园",
    "磨山景区",
    "东湖生态旅游风景区",
    "万国公园",
    "东湖绿道",
    "东湖落雁景区",
    "万林艺术博物馆",
    "武汉大学樱园",
    "光谷科技港",
    "东湖生态旅游风景区-听涛景区",
    "湖北省博物馆",
    "名人文化公园",
    "武汉东湖海洋乐园",
    "湖北美术馆",
    "武汉东湖飞鸟世界",
    "东湖生态旅游风景区-梨园",
    "石门峰纪念公园",
    "宝通禅寺",
    "武汉九峰山森林动物园",
    "武汉杜莎夫人蜡像馆",
    "武汉欢乐谷",
    "洪山广场",
    "玛雅海滩水公园",
    "武汉自由时刻体育公园",
    "沙湖公园",
    "维佳童话镇",
    "武昌城市公园",
    "长春观",
    "合美术馆",
    "首义公园",
    "起义门",
    "武汉威尼斯水世界",
    "紫阳公园",
    "辛亥革命博物馆",
    "首义广场",
    "武昌红楼",
    "辛亥革命武昌起义纪念馆",
    "昙华林",
    "藏龙岛国家湿地公园",
    "黄鹤楼公园",
    "公园家",
    "黄鹤楼",
    "张公山寨度假山庄",
    "武昌廉政文化公园",
    "武汉革命博物馆",
    "毛泽东同志旧居",
    "武昌江滩",
    "中共五大会址纪念馆",
    "武汉长江大桥建成纪念碑",
    "和平公园",
    "青山公园",
    "武汉江滩",
    "武汉科学技术馆(新馆)",
    "江汉关博物馆",
    "江汉关大楼旧址",
    "知音号服务中心",
    "黎黄陂路街头博物馆",
    "宋庆龄汉口旧居纪念馆",
    "汉口江滩芦苇荡",
    "平和打包厂旧址",
    "汉口江滩",
    "八七会议会址纪念馆",
    "晴川阁景区",
    "首善堂",
    "汉阳江滩",
    "汉口水塔",
    "武汉美术馆",
    "吉庆民俗街",
    "莲花湖公园",
    "国货商场旧址",
    "吴佩孚公馆旧址",
    "龙泉山",
    "孝恩园",
    "汉阳树",
    "济生路电话分局旧址",
    "汉阳公园",
    "古德寺",
    "解放公园",
    "武汉二七纪念馆",
    "龟山风景区",
    "汉阳造广告创意园",
    "宝岛公园",
    "古琴台",
    "归元禅寺",
    "中山公园",
    "武汉市江夏中央大公园",
    "硚口公园",
    "堤角公园",
    "谭鑫培公园",
    "武汉国际会议中心",
    "武汉国际博览中心-B馆",
    "武汉动物园",
    "张之洞与武汉博物馆",
    "武汉博物馆",
    "首地云梦台",
    "墨水湖公园",
    "武汉海昌极地海洋公园",
    "青龙山国家森林公园",
    "常青公园",
    "白云洞景区",
    "农耕年华农业风情园",
    "汉口里",
    "武汉自然博物馆",
    "梵高星空艺术馆",
    "武汉园博园",
    "盘龙城国家考古遗址公园",
    "武汉28街",
    "汤湖公园",
    "金银湖国家城市湿地公园",
    "龙灵山公园鸟语林",
    "梁子湖风景区",
    "龙灵山生态公园",
    "府河湿地",
    "武汉市中山舰博物馆",
    "武汉花博汇",
    "后官湖湿地公园",
    "武汉野战国防园",
    "木兰水镇旅游景区",
    "木兰草原风景区",
    "大余湾",
    "凤娃古寨",
    "问津书院",
    "黄陂木兰文化生态旅游区",
    "木兰湖风景区",
    "木兰山",
    "黄陂云雾山",
    "木兰天池",
    "道观河风景旅游区",
    "木兰花乡旅游风景区",
    "武汉姚家山风景区",
    "锦里沟",
    "木兰清凉寨"
];
            var lats = [
    30.508348,
    30.506961,
    30.523685,
    30.531083,
    30.543991,
    30.535619,
    30.546719,
    30.550553,
    30.525509,
    30.554438,
    30.557869,
    30.552503,
    30.560913,
    30.565409,
    30.542966,
    30.545372,
    30.461976,
    30.573998,
    30.567828,
    30.520022,
    30.580246,
    30.570295,
    30.580191,
    30.580049,
    30.519637,
    30.538026,
    30.507093,
    30.561264,
    30.59723,
    30.551205,
    30.601424,
    30.581241,
    30.570093,
    30.600035,
    30.53068,
    30.546129,
    30.47614,
    30.547674,
    30.531473,
    30.566331,
    30.536059,
    30.542703,
    30.543105,
    30.547724,
    30.547866,
    30.557656,
    30.407904,
    30.549265,
    30.630262,
    30.550317,
    30.594996,
    30.556278,
    30.559296,
    30.556688,
    30.564553,
    30.556493,
    30.552037,
    30.640541,
    30.643937,
    30.591177,
    30.584887,
    30.581695,
    30.582065,
    30.602596,
    30.592207,
    30.592172,
    30.611724,
    30.58793,
    30.613846,
    30.592243,
    30.561284,
    30.593532,
    30.553138,
    30.584657,
    30.58978,
    30.591314,
    30.55679,
    30.58743,
    30.590487,
    30.417594,
    30.401576,
    30.553814,
    30.582471,
    30.556796,
    30.624312,
    30.614185,
    30.64069,
    30.560653,
    30.561859,
    30.603562,
    30.560568,
    30.551579,
    30.592775,
    30.386707,
    30.576552,
    30.667607,
    30.375272,
    30.5122,
    30.515665,
    30.548359,
    30.566294,
    30.617735,
    30.660439,
    30.554838,
    30.67007,
    30.33248,
    30.626637,
    30.352154,
    30.725895,
    30.626129,
    30.630478,
    30.539707,
    30.632221,
    30.700211,
    30.720508,
    30.470829,
    30.647263,
    30.444503,
    30.246303,
    30.432411,
    30.728056,
    30.351522,
    30.494232,
    30.551139,
    30.487962,
    30.96547,
    30.965057,
    31.032703,
    30.916743,
    30.801328,
    31.099165,
    31.102567,
    31.108406,
    31.129903,
    31.183693,
    30.879218,
    31.243822,
    31.25758,
    31.278887,
    31.301474
];
			var lngs = [
    114.413194,
    114.41587,
    114.40699,
    114.441192,
    114.420846,
    114.438673,
    114.413254,
    114.429948,
    114.453804,
    114.419704,
    114.420005,
    114.449386,
    114.448108,
    114.442959,
    114.369636,
    114.369037,
    114.406322,
    114.381692,
    114.371879,
    114.488549,
    114.386792,
    114.371902,
    114.384447,
    114.381562,
    114.494342,
    114.347202,
    114.497517,
    114.350992,
    114.399429,
    114.343531,
    114.403582,
    114.360803,
    114.344803,
    114.37462,
    114.326784,
    114.327304,
    114.330573,
    114.320165,
    114.313849,
    114.322105,
    114.311781,
    114.312357,
    114.312126,
    114.312924,
    114.312911,
    114.315578,
    114.431083,
    114.312194,
    114.404496,
    114.309043,
    114.511584,
    114.306432,
    114.306917,
    114.305815,
    114.308665,
    114.3053,
    114.300509,
    114.392493,
    114.414695,
    114.311104,
    114.306519,
    114.30403,
    114.304163,
    114.317119,
    114.308826,
    114.308773,
    114.323223,
    114.304258,
    114.324321,
    114.306376,
    114.291314,
    114.305489,
    114.286939,
    114.296693,
    114.299543,
    114.300269,
    114.284529,
    114.296684,
    114.296916,
    114.522843,
    114.504545,
    114.277296,
    114.286698,
    114.275846,
    114.314118,
    114.304546,
    114.330712,
    114.274523,
    114.274014,
    114.290888,
    114.270253,
    114.265693,
    114.277733,
    114.32272,
    114.263404,
    114.344703,
    114.330318,
    114.250672,
    114.248893,
    114.248496,
    114.249395,
    114.263081,
    114.294876,
    114.221244,
    114.285069,
    114.339468,
    114.244426,
    114.294977,
    114.467636,
    114.231369,
    114.229214,
    114.195923,
    114.222347,
    114.275858,
    114.268971,
    114.168803,
    114.193838,
    114.139195,
    114.527029,
    114.126634,
    114.190862,
    114.139869,
    114.083012,
    114.07503,
    113.98201,
    114.435298,
    114.467058,
    114.378543,
    114.760832,
    114.90328,
    114.403265,
    114.477954,
    114.399456,
    114.219888,
    114.291544,
    115.00976,
    114.394268,
    114.200322,
    114.233116,
    114.223129
];

            var distance = [];
            var transitJuli =[];
            //var distance= [3705, 3901, 7064, 3604, 3036, 5637, 2801, 9813, 3597, 4717, 3705, 3901, 7064, 3604, 3036, 5637, 2801, 9821, 3597, 4717, 3711, 3901, 7064, 3604, 3036, 5637, 2801, 9821, 3597, 4717, 8547, 7354, 3266, 6480, 9390, 9220, 3021, 2239, 11356, 3420, 4665, 6373, 5395, 6508, 8896, 4249, 3432, 3570, 4717, 5964, 2206, 4180, 8438, 3824, 6177, 3994, 5824, 3257, 4490, 7147, 6224, 5968, 3589, 7950, 5090, 4575, 4395, 6243, 7058, 5171, 4809, 3742, 4004, 4133, 4998, 7781, 7157, 9911, 7376, 4849, 3161, 6123, 18721, 5504, 5748, 5595, 5059, 5573, 3442, 7220, 5281, 4068, 3098, 3775, 3915, 3915, 4069, 7729, 4097, 5352];
            //testUrl= http://api.map.baidu.com/directionlite/v1/transit?origin=30.58292%2C114.340713&destination=30.602735,114.344745&ak=hAWqwsd60vmWtLgHb4S7u46r7yiHlNj2
            // var filename = "file.xlsx"; //文件名称
            // var data = [];  //数据，一定注意需要时二维数组
            // data.push(["name","lng","lat"]);
            // for(var i=0;i<50;i++ )
            // {
            //     data.push([names[i],lng[i],lat[i]]);
            // }
            debugger;
            // var ws_name = "Sheet1"; //Excel第一个sheet的名称
            // var wb = XLSX.utils.book_new(), ws = XLSX.utils.aoa_to_sheet(data);
            // XLSX.utils.book_append_sheet(wb, ws, ws_name);  //将数据添加到工作薄
            // XLSX.writeFile(wb, filename); //导出Excel
            var myVal = setInterval(function () {
                if (count < 140) {
                    var myurl = "http://api.map.baidu.com/direction/v2/transit?origin=30.58292%2C114.340713&destination=" + lats[count] + "%2C" + lngs[count] + "&ak=hAWqwsd60vmWtLgHb4S7u46r7yiHlNj2";
                    $.ajax({
                        url: myurl,
                        type: "get",
                        dataType: "jsonp",
                        success: function (result) {
                            debugger;
                            if (result.status == 1001 || result.status == 1000) {
                                distance.push(0);
                                count++;
                            }
                            else {
                                var juli = [];
                                for (var i = 0; i < result.result.routes.length; i++) {
                                    juli.push(result.result.routes[i].duration)
                                }
                                distance.push(Math.min.apply(Math, juli));
                                count++;
                                // distance.push(result.result.routes[0].duration)
                                // count++;
                            }

                            // for(var i=0;i<10;i++)
                            // {   
                            //   uids.push(result.results[i].uid);
                            //   names.push(result.results[i].name);
                            //   lats.push(result.results[i].location.lat)
                            //   lngs.push(result.results[i].location.lng)
                            // }
                            // count++;


                            //返回成功进行响应操作
                            //把获取信息填写在当中//现在还差image字段传值
                        }
                    });
                }
                else {
                    clearInterval(myVal);
                    alert("当前进程已结束");
                    console.log(distance);
                }
            }, 1000);
        }
    </script>
</body>

</html>